================================================================================
TutorGPT Book Content Ingestion
================================================================================

[1/5] Initializing services...
Loading embedding model: all-mpnet-base-v2...
This is a FREE local model - no API key needed! ðŸŽ‰
âœ… Model loaded successfully!
   Embedding dimension: 768

[2/5] Resetting vector store...
Deleted collection: book_content

[3/5] Parsing all lessons...
Found 107 markdown files
âœ“ Parsed 2026 chunks from book content

[4/5] Generating embeddings (batch size: 25)...
Embedding batches:   0%|          | 0/82 [00:00<?, ?it/s]Embedding batches:   1%|          | 1/82 [00:02<02:44,  2.03s/it]Embedding batches:   2%|â–         | 2/82 [00:06<05:00,  3.75s/it]Embedding batches:   4%|â–Ž         | 3/82 [00:12<06:10,  4.69s/it]Embedding batches:   5%|â–         | 4/82 [00:18<06:36,  5.08s/it]Embedding batches:   6%|â–Œ         | 5/82 [00:23<06:42,  5.23s/it]Embedding batches:   7%|â–‹         | 6/82 [00:29<06:46,  5.34s/it]Embedding batches:   9%|â–Š         | 7/82 [00:35<06:44,  5.40s/it]Embedding batches:  10%|â–‰         | 8/82 [00:40<06:51,  5.56s/it]Embedding batches:  11%|â–ˆ         | 9/82 [00:45<06:15,  5.14s/it]Embedding batches:  12%|â–ˆâ–        | 10/82 [00:48<05:29,  4.58s/it]Embedding batches:  13%|â–ˆâ–Ž        | 11/82 [00:51<04:51,  4.11s/it]Embedding batches:  15%|â–ˆâ–        | 12/82 [00:54<04:24,  3.78s/it]Embedding batches:  16%|â–ˆâ–Œ        | 13/82 [00:59<04:50,  4.21s/it]Embedding batches:  17%|â–ˆâ–‹        | 14/82 [01:01<03:53,  3.43s/it]Embedding batches:  18%|â–ˆâ–Š        | 15/82 [01:06<04:28,  4.00s/it]Embedding batches:  20%|â–ˆâ–‰        | 16/82 [01:11<04:37,  4.21s/it]Embedding batches:  21%|â–ˆâ–ˆ        | 17/82 [01:16<04:51,  4.48s/it]Embedding batches:  22%|â–ˆâ–ˆâ–       | 18/82 [01:22<05:07,  4.80s/it]Embedding batches:  23%|â–ˆâ–ˆâ–Ž       | 19/82 [01:28<05:25,  5.17s/it]Embedding batches:  24%|â–ˆâ–ˆâ–       | 20/82 [01:33<05:29,  5.31s/it]Embedding batches:  26%|â–ˆâ–ˆâ–Œ       | 21/82 [01:38<05:10,  5.08s/it]Embedding batches:  27%|â–ˆâ–ˆâ–‹       | 22/82 [01:41<04:38,  4.63s/it]Embedding batches:  28%|â–ˆâ–ˆâ–Š       | 23/82 [01:47<04:52,  4.95s/it]Embedding batches:  29%|â–ˆâ–ˆâ–‰       | 24/82 [01:52<04:48,  4.97s/it]Embedding batches:  30%|â–ˆâ–ˆâ–ˆ       | 25/82 [01:58<05:00,  5.28s/it]Embedding batches:  32%|â–ˆâ–ˆâ–ˆâ–      | 26/82 [02:03<04:44,  5.09s/it]Embedding batches:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 27/82 [02:07<04:25,  4.84s/it]Embedding batches:  34%|â–ˆâ–ˆâ–ˆâ–      | 28/82 [02:10<03:47,  4.21s/it]Embedding batches:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 29/82 [02:11<02:56,  3.34s/it]Embedding batches:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 30/82 [02:17<03:29,  4.03s/it]Embedding batches:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 31/82 [02:22<03:50,  4.52s/it]Embedding batches:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 32/82 [02:27<03:50,  4.61s/it]Embedding batches:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 33/82 [02:31<03:30,  4.30s/it]Embedding batches:  41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 34/82 [02:36<03:47,  4.73s/it]Embedding batches:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 35/82 [02:42<03:47,  4.84s/it]Embedding batches:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 36/82 [02:46<03:30,  4.57s/it]Embedding batches:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 37/82 [02:49<03:09,  4.22s/it]Embedding batches:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 38/82 [02:55<03:23,  4.63s/it]Embedding batches:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 39/82 [03:00<03:31,  4.91s/it]Embedding batches:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 40/82 [03:05<03:32,  5.05s/it]Embedding batches:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 41/82 [03:11<03:33,  5.20s/it]Embedding batches:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 42/82 [03:16<03:22,  5.06s/it]Embedding batches:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 43/82 [03:21<03:21,  5.16s/it]Embedding batches:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 44/82 [03:26<03:14,  5.12s/it]Embedding batches:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 45/82 [03:31<03:01,  4.90s/it]Embedding batches:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 46/82 [03:36<03:04,  5.13s/it]Embedding batches:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 47/82 [03:40<02:41,  4.61s/it]Embedding batches:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 48/82 [03:44<02:30,  4.43s/it]Embedding batches:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 49/82 [03:49<02:37,  4.77s/it]Embedding batches:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 50/82 [03:55<02:39,  4.98s/it]Embedding batches:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 51/82 [04:00<02:32,  4.93s/it]Embedding batches:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 52/82 [04:05<02:34,  5.16s/it]Embedding batches:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 53/82 [04:11<02:36,  5.41s/it]Embedding batches:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 54/82 [04:17<02:32,  5.45s/it]Embedding batches:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 55/82 [04:23<02:31,  5.60s/it]Embedding batches:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 56/82 [04:29<02:29,  5.74s/it]Embedding batches:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 57/82 [04:35<02:25,  5.81s/it]Embedding batches:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 58/82 [04:41<02:21,  5.90s/it]Embedding batches:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 59/82 [04:46<02:13,  5.79s/it]Embedding batches:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 60/82 [04:53<02:09,  5.90s/it]Embedding batches:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 61/82 [04:58<01:59,  5.69s/it]Embedding batches:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 62/82 [05:04<01:56,  5.83s/it]Embedding batches:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 63/82 [05:10<01:54,  6.00s/it]Embedding batches:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 64/82 [05:14<01:35,  5.31s/it]Embedding batches:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 65/82 [05:20<01:35,  5.60s/it]Embedding batches:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 66/82 [05:26<01:32,  5.79s/it]Embedding batches:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 67/82 [05:29<01:13,  4.92s/it]Embedding batches:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 68/82 [05:31<00:56,  4.05s/it]Embedding batches:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 69/82 [05:38<01:01,  4.71s/it]Embedding batches:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 70/82 [05:44<01:02,  5.21s/it]Embedding batches:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 71/82 [05:48<00:52,  4.74s/it]Embedding batches:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 72/82 [05:53<00:49,  4.96s/it]Embedding batches:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 73/82 [05:59<00:46,  5.20s/it]Embedding batches:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 74/82 [06:02<00:35,  4.47s/it]Embedding batches:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 75/82 [06:08<00:34,  4.93s/it]Embedding batches:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 76/82 [06:11<00:27,  4.53s/it]Embedding batches:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 77/82 [06:14<00:19,  3.97s/it]Embedding batches:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 78/82 [06:16<00:13,  3.46s/it]Embedding batches:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 79/82 [06:23<00:13,  4.35s/it]Embedding batches:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 80/82 [06:26<00:07,  3.96s/it]Embedding batches:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 81/82 [06:30<00:04,  4.21s/it]Embedding batches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 82/82 [06:31<00:00,  4.77s/it]
âœ“ Generated 2026 embeddings

[5/5] Storing in vector database...


âŒ Error during ingestion: Expected IDs to be unique, found 17 duplicated IDs: chunk_ch02_l07_s16_c00, chunk_ch02_l07_s03_c00, chunk_ch02_l07_s04_c00, chunk_ch02_l07_s01_c00, chunk_ch02_l07_s05_c00, ..., chunk_ch02_l07_s07_c00, chunk_ch02_l07_s08_c00, chunk_ch02_l07_s11_c00, chunk_ch02_l07_s14_c00, chunk_ch02_l07_s09_c00 in upsert.
Traceback (most recent call last):
  File "/home/user/ai-native-software-development/Tutor/backend/scripts/ingest_book.py", line 218, in main
    ingest_book_content(
  File "/home/user/ai-native-software-development/Tutor/backend/scripts/ingest_book.py", line 102, in ingest_book_content
    vector_store.upsert_chunks(
  File "/home/user/ai-native-software-development/Tutor/backend/app/services/vector_store.py", line 187, in upsert_chunks
    collection.upsert(
  File "/home/user/ai-native-software-development/Tutor/backend/.venv/lib/python3.11/site-packages/chromadb/api/models/Collection.py", line 449, in upsert
    upsert_request = self._validate_and_prepare_upsert_request(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/ai-native-software-development/Tutor/backend/.venv/lib/python3.11/site-packages/chromadb/api/models/CollectionCommon.py", line 103, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/ai-native-software-development/Tutor/backend/.venv/lib/python3.11/site-packages/chromadb/api/models/CollectionCommon.py", line 441, in _validate_and_prepare_upsert_request
    validate_insert_record_set(record_set=upsert_records)
  File "/home/user/ai-native-software-development/Tutor/backend/.venv/lib/python3.11/site-packages/chromadb/api/types.py", line 437, in validate_insert_record_set
    validate_ids(record_set["ids"])
  File "/home/user/ai-native-software-development/Tutor/backend/.venv/lib/python3.11/site-packages/chromadb/api/types.py", line 980, in validate_ids
    raise errors.DuplicateIDError(message)
chromadb.errors.DuplicateIDError: Expected IDs to be unique, found 17 duplicated IDs: chunk_ch02_l07_s16_c00, chunk_ch02_l07_s03_c00, chunk_ch02_l07_s04_c00, chunk_ch02_l07_s01_c00, chunk_ch02_l07_s05_c00, ..., chunk_ch02_l07_s07_c00, chunk_ch02_l07_s08_c00, chunk_ch02_l07_s11_c00, chunk_ch02_l07_s14_c00, chunk_ch02_l07_s09_c00 in upsert.
